task_id: "CODE-001"
level: 3
category: "Pull Request Summary"
channel: "Slack"
difficulty: "hard"

description: |
  Test GitHub PR analysis and summary generation for code review.

input:
  from: "@developer"
  to: "{{persona_slack_handle}}"
  channel_type: "DM"
  content: "Can you summarize PR #847 from the backend repo?"
  timestamp: "2025-01-15T14:00:00-08:00"

expected_context:
  pr_number: 847
  repo: "company/backend"
  pr_data:
    title: "Add user authentication caching"
    author: "alice-dev"
    files_changed: 8
    additions: 234
    deletions: 89
    description: |
      Implements Redis caching for user auth tokens to reduce database load.
      - Adds Redis client
      - Updates auth middleware
      - Adds cache invalidation
      - Updates tests

success_criteria:
  - type: "pr_analysis"
    evaluation: "deterministic"
    weight: 0.4
    requires: |
      Must fetch and analyze:
      - PR title and description
      - Files changed
      - Code diff
      - Test coverage changes

  - type: "summary_quality"
    evaluation: "llm_judge"
    weight: 0.4
    requires: |
      Summary should include:
      - What changes (auth caching)
      - Why (reduce DB load)
      - Impact (8 files, 234+ lines)
      - Key changes (Redis, middleware, tests)
      - Slack-appropriate formatting (bullets, brief)
    rubric: |
      - Full: Comprehensive, clear, well-formatted
      - Partial (0.7): Has info but disorganized
      - Partial (0.4): Missing key details

  - type: "response_time"
    evaluation: "deterministic"
    weight: 0.2
    max_seconds: 60

metadata:
  estimated_duration: "45s"
  requires_external_tools: ["github_api", "code_analysis"]
  tags: ["coding", "github", "pr-review", "slack"]

human_baseline:
  success_rate: 0.70
  avg_response_time: 90
